(function(c,b){if(b.scrupload){return}var d=b.scrupload=b.scrupload||{},a=0;d.SELECTED=1;d.UPLOADING=2;d.FAILED=3;d.DONE=4;d.ERROR_TYPE="TYPE";d.ERROR_SIZE="SIZE";d.ERROR_HTTP="HTTP";d.uniqid=function(g){var f=new Date().getTime().toString(32),e;for(e=0;e<5;e++){f+=Math.floor(Math.random()*65535).toString(32)}return("scrupload-"+f).toString(32)};d.buildUrlQuery=function(e,g){var f=c.param(g);if(!f){return e}else{return f.indexOf("?")!=-1?e+"&"+f:e+"?"+f}};d.generateElementId=function(e){var f=e.attr("id");if(f){return f}while(true){f=this.uniqid();if(c("#"+f).length===0){e.attr("id",f);return f}}};d.buildDefaultOptions=function(g){if(g.types){g.post_params.types=g.types}if(g.size_limit){var f=g.size_limit;var e;if(e=f.match(/^([0-9]+)MB$/i)){g.size_limit=e[1]*1024*1024}else{if(e=f.match(/^([0-9]+)KB$/i)){g.size_limit=e[1]*1024}else{if(e=f.match(/^([0-9]+)B?$/i)){g.size_limit=e[1]}else{throw g.size_limit+" is illegal size_limit value."}}}g.post_params.size_limit=g.size_limit}};d.checkTypes=function(h,f){if(h.options.types&&f.type){var g=h.options.types.split("|"),e;if(c.inArray(f.type,g)==-1){f.errors.push({type:scrupload.ERROR_TYPE});f.status=scrupload.FAILED}}};d.checkSize=function(f,e){if(f.options.size_limit&&e.size){if(e.size>f.options.size_limit){e.errors.push({type:scrupload.ERROR_SIZE});e.status=scrupload.FAILED}}};d.defaultOptions=function(e){return c.extend({},{file_post_name:"file",post_params:{},get_params:{},interval:0},e||{})};d.initButtonEvent=function(g,f){var e=false;f.mouseout(function(){if(e){g._trigger("onButtonOut",null,{element:g.element,runtime:g.runtime,options:g.options});e=false}}).mouseover(function(){if(!e){g._trigger("onButtonOver",null,{element:g.element,runtime:g.runtime,options:g.options});e=true}}).mousedown(function(){g._trigger("onButtonDown",null,{element:g.element,runtime:g.runtime,options:g.options})})};d.createFile=function(f,e){return{id:(e.file_id_prefix||"scrfile-"+(++a)),time:new Date(),filename:f.name||f.fileName,size:f.size,type:d.detectFileType(f),status:this.SELECTED,errors:[],get:c.extend({},e.get_params),post:c.extend({},e.post_params)}};d.detectFileType=function(g){var h,e,f;if(g.type){if(g.type.indexOf("/")==-1){h=g.type.substr(1).toLowerCase()}}if(!h){e=g.name||g.fileName;f=e.lastIndexOf(".");if(f==-1){h=false}else{h=e.substr(f+1).toLowerCase()}}return h};d.onSelect=function(f,e){f._trigger("onSelect",null,{element:f.element,runtime:f.runtime,file:e,options:f.options});if(e.errors.length>0){f._trigger("onError",null,{element:f.element,file:e,runtime:f.runtime,options:f.options})}};d.submitIframForm=function(i,f,j,h){var e=j,g;g=scrupload.createFile({name:f},e.options);(h||c.noop)(g);if(f!="n/a"){scrupload.checkTypes(e,g)}e._trigger("onDialogClose",null,{element:e.element,runtime:e.runtime,selected:[g],options:e.options});scrupload.onSelect(e,g);e._trigger("onStartUpload",null,{element:e.element,runtime:e.runtime,queue:g.errors.length===0?[g]:[],options:e.options});if(g.errors.length==0){e._trigger("onFileStart",null,{element:e.element,runtime:e.runtime,file:g,options:e.options});i.submit(function(){g.post.id=g.id;g.post.post_name=e.options.file_post_name;c.each(g.post,function(l){i.append('<input type="hidden" name="'+l+'" value="'+this+'" />')});var k=i.attr("action");k=scrupload.buildUrlQuery(k,g.get);i.attr("action",k);g.status=scrupload.UPLOADING;e._trigger("onProgress",null,{element:e.element,runtime:e.runtime,file:g,progress:{percent:0},options:e.options})});i.attr("target",g.id);i.find("input[name=id]").val(g.id);c('<iframe src="about:blank" name="'+g.id+'">').appendTo(document.body).css({width:"1px",height:"1px",position:"absolute",left:"-10000px",top:"-10000px"}).load(function(){var k=c(this),l=c(this.contentWindow.document.body).text();if(l){e._trigger("onProgress",null,{element:e.element,file:g,runtime:e.runtime,progress:{percent:100},options:e.options});g.status=scrupload.DONE;e._trigger("onFileComplete",null,{element:e.element,file:g,runtime:e.runtime,response:l,options:e.options});e._trigger("onComplete",null,{element:e.element,uploaded:[g],runtime:e.runtime,options:e.options})}setTimeout(function(){k.remove();i.remove();e._resetInterface();e.element.removeClass("scr_uploading")},0)});i.submit()}else{i.remove();e._resetInterface();e.element.removeClass("scr_uploading");e._trigger("onComplete",null,{element:e.element,uploaded:[g],runtime:e.runtime,options:e.options})}};d.disableInterface=function(f,e){cover=f.data("disable-cover");if(!cover){cover=c("<div></div>").appendTo(f).css("position","absolute").css("top",0).css("left",0).css("z-index",10000).offset(f.offset()).width(f.width()).height(f.height());f.data("disable-cover",cover)}cover.show()};d.enableInterface=function(f,e){cover=f.data("disable-cover");if(cover){cover.hide()}}})(jQuery,(function(){return this})());(function(b){var a=new RegExp("([^/?]+)\\??[^/]*$");b.widget("ui.scruploadHttp",{options:scrupload.defaultOptions({button_value:"OK"}),_create:function(){var c=this;c.element.addClass("scr_http_container");c.queue_array=[];scrupload.buildDefaultOptions(c.options);c._initInterface();c.runtime={name:"http",object:c.input};c._trigger("onInit",null,{element:c.element,runtime:c.runtime,options:c.options})},_initInterface:function(){var c=this,d;c.container=b("<span></span>").appendTo(c.element);c.input=b('<input type="text">').appendTo(c.container);d=b('<input type="submit" value="'+c.options.button_value+'">').appendTo(c.container);scrupload.initButtonEvent(c,c.container);d.click(function(){var g=b('<form action="'+c.options.url+'" method="post" />'),e="n/a",f=b(this),h=c.input.val();c.element.addClass("scr_uploading");c.input.attr("name",c.options.file_post_name);g.appendTo(c.element).append(c.container);if(a.exec(h)){e=RegExp.$1}scrupload.submitIframForm(g,e,c,function(i){i.post.filename=e;i.http={uri:h};if(!h.match(/^https?:\/\//)){i.errors.push({type:scrupload.ERROR_HTTP});i.status=scrupload.FAILED}});return false})},_resetInterface:function(){this.container.remove();this._initInterface()},destroy:function(){this.element.removeClass("scr_http_container");this.container.remove();this.queue_array=[];this.input=undefined;b.Widget.prototype.destroy.apply(this,arguments);return this}})})(jQuery);(function(a){a.widget("ui.scruploadHtml4",{options:scrupload.defaultOptions({}),_create:function(){var b=this;b.element.addClass("scr_html4_container");b.queue_array=[];scrupload.buildDefaultOptions(b.options);b._initInterface();b.runtime={name:"html4",object:b.input};b._trigger("onInit",null,{element:b.element,runtime:b.runtime,options:b.options})},_initInterface:function(){var b=this;b._createFormAndInput()},_createFormAndInput:function(){var b=this;b.input=a('<input type="file" />');b.container=a("<span />");b.input.appendTo(b.container.appendTo(b.element));scrupload.initButtonEvent(b,b.container);b.input.change(function(){var f=a('<form action="'+b.options.url+'" method="post" enctype="multipart/form-data" />'),e="n/a",c,d=a(this);b.element.addClass("scr_uploading");d.attr("name",b.options.file_post_name);f.appendTo(b.element).append(b.container);if(this.value){e=this.value;c=e.match(/[\/\\]([^\/\\]+)$/i);if(c){e=c[1]}}scrupload.submitIframForm(f,e,b)})},_resetInterface:function(){this.container.remove();this._initInterface()},destroy:function(){this.element.removeClass("scr_html4_container");this.container.remove();this.queue_array=[];this.input=undefined;a.Widget.prototype.destroy.apply(this,arguments);return this}})})(jQuery);(function(a){a.widget("ui.scruploadHtml5",{options:scrupload.defaultOptions({mutiple_select:true}),_create:function(){var b=this;b.element.addClass("scr_html5_container");b.queue_array=[];scrupload.buildDefaultOptions(b.options);b._initInterface();b.runtime={name:"html5",object:b.input};b._trigger("onInit",null,{element:b.element,runtime:b.runtime,options:b.options})},_initInterface:function(){var b=this;b.selected_array=[];b.uploaded_array=[];b._createFormAndInput()},_createFormAndInput:function(){var b=this,c;c=b.options.file_post_name;if(b.options.mutiple_select){b.input=a('<input type="file" name="'+c+'" multiple />')}else{b.input=a('<input type="file" name="'+c+'" />')}b.container=a("<span />");b.input.appendTo(b.container.appendTo(b.element));scrupload.initButtonEvent(b,b.container);b.input.change(function(){var e,f,d="n/a",m,k=a(this),g,j;b.input.attr("disabled","disabled");b.element.addClass("scr_uploading");f=a('<form method="post" enctype="multipart/form-data" />');f.appendTo(b.element).append(b.container);for(var h=0;h<this.files.length;h++){g=scrupload.createFile(this.files[h],b.options);fd=new FormData();fd.append(c,this.files[h]);fd.append("id",g.id);fd.append("post_name",c);for(var l in g.post){fd.append(l,g.post[l])}e=scrupload.buildUrlQuery(b.options.url,g.get);f.attr("action",e);g.html5={formData:fd,uri:e};scrupload.checkTypes(b,g);scrupload.checkSize(b,g);b.selected_array.push(g)}b._trigger("onDialogClose",null,{element:b.element,runtime:b.runtime,selected:b.selected_array,options:b.options});a.each(b.selected_array,function(){var i=this;scrupload.onSelect(b,i);if(i.errors.length==0){b.queue_array.push(i)}});b._trigger("onStartUpload",null,{element:b.element,runtime:b.runtime,queue:b.queue_array,options:b.options});j=b.queue_array.shift();if(j){b._onFileStart(j);b._upload(j)}else{b._onComplete()}})},_upload:function(b){var c=new XMLHttpRequest();this._setAjaxEventListener(c,b);c.open("POST",b.html5.uri);c.send(b.html5.formData)},_onFileStart:function(b){this._trigger("onFileStart",null,{element:this.element,runtime:this.runtime,file:b,options:this.options})},_setAjaxEventListener:function(d,c){var b=this;d.upload.addEventListener("progress",function(f){c.status=scrupload.UPLOADING;if(f.lengthComputable){var e=Math.round(f.loaded*100/f.total);b._trigger("onProgress",null,{element:b.element,runtime:b.runtime,file:c,options:b.options,progress:{percent:e,bytes_loaded:f.loaded,bytes_total:f.total}})}},false);d.addEventListener("load",function(f){var e;c.status=scrupload.DONE;b._trigger("onFileComplete",null,{element:b.element,runtime:b.runtime,file:c,response:f.target.responseText,options:b.options});b.uploaded_array.push(c);if(b.queue_array.length==0){b._onComplete()}else{e=b.queue_array.shift();b._onFileStart(e);setTimeout(function(){b._upload(e)},b.options.interval)}},false)},_onComplete:function(){this._trigger("onComplete",null,{element:this.element,runtime:this.runtime,uploaded:self.uploaded_array,options:this.options});this._resetInterface()},_resetInterface:function(){this.container.remove();this._initInterface()},destroy:function(){this.element.removeClass("scr_html5_container");this.container.remove();this.queue_array=[];this.input=undefined;a.Widget.prototype.destroy.apply(this,arguments);return this}})})(jQuery);(function(a){if(window.SWFUpload){a.widget("ui.scruploadSwfupload",{options:scrupload.defaultOptions({swfupload:{prevent_swf_caching:false,button_cursor:SWFUpload.CURSOR.HAND},mutiple_select:true}),_create:function(){var b=this;b.queue_array=[];b.uploaded_array=[];b.selected_array=[];scrupload.buildDefaultOptions(b.options);b._initInterface()},_initInterface:function(){var b=this,h={},g,j={},c={},d,f,e;b.swf_container=a("<div><div></div></div>").appendTo(b.element);b.swf_container.width(b.options.swfupload.button_width);b.swf_container.height(b.options.swfupload.button_height);if(b.options.swfupload.cookie){if(!a.cookie){throw'It is require "jquery.cookie.js" to use cookie option.'}if((b.options.swfupload.cookie_method||"get").toLowerCase()=="get"){for(d=0;d<b.options.swfupload.cookie.length;d++){c[b.options.swfupload.cookie[d]]=a.cookie(b.options.swfupload.cookie[d])}}else{for(d=0;d<b.options.swfupload.cookie.length;d++){j[b.options.swfupload.cookie[d]]=a.cookie(b.options.swfupload.cookie[d])}}delete b.options.swfupload.cookie;delete b.options.swfupload.cookie_method}b.swfuploader=null;g=a.extend(b.options.swfupload,{file_post_name:b.options.file_post_name,upload_url:b.options.url,file_size_limit:b.options.size_limit,button_placeholder_id:scrupload.generateElementId(b.swf_container.find("div")),preserve_relative_urls:true,button_window_mode:SWFUpload.WINDOW_MODE.TRANSPARENT,swfupload_loaded_handler:function(){b.runtime={name:"swfupload",object:b.swfuploader};b._trigger("onInit",null,{element:b.element,runtime:b.runtime,options:b.options})},file_dialog_start_handler:function(k,i,l){e=false},file_queued_handler:function(k){var i=scrupload.createFile(k,b.options);e=true;i.swfupload={file:k};h[k.id]=i;scrupload.checkTypes(b,i);scrupload.checkSize(b,i);b.selected_array.push(i)},file_dialog_complete_handler:function(i,k){b._trigger("onDialogClose",null,{element:b.element,runtime:b.runtime,selected:b.selected_array,options:b.options});a.each(b.selected_array,function(){var l=this;scrupload.onSelect(b,l);if(l.errors.length==0){b.queue_array.push(l)}else{b.swfuploader.cancelUpload(l.swfupload.file.id)}});b._trigger("onStartUpload",null,{element:b.element,runtime:b.runtime,queue:b.queue_array,options:b.options});if(b.queue_array.length>0){scrupload.disableInterface(b.element,b.options);this.startUpload()}else{if(e){b._onComplete()}}},upload_start_handler:function(m){var l=h[m.id],k,i=this;if(b.uploaded_array.length>0){if(f!=l){this.stopUpload();f=l;b._onFileStart(l,j,c);setTimeout(function(){b.swfuploader.startUpload()},b.options.interval)}}else{f=l;b._onFileStart(l,j,c);b.swfuploader.startUpload()}},upload_progress_handler:function(n,k,m){var i=h[n.id],l=Math.ceil((k/m)*100);i.status=scrupload.UPLOADING;b._trigger("onProgress",null,{element:b.element,runtime:b.runtime,file:i,options:b.options,progress:{percent:l,bytes_loaded:k,bytes_total:m}})},upload_success_handler:function(k,l){var i=h[k.id];i.status=scrupload.DONE;b.uploaded_array.push(i);b._trigger("onFileComplete",null,{element:b.element,runtime:b.runtime,file:i,response:l,options:b.options})},queue_complete_handler:function(i){b._onComplete();scrupload.enableInterface(b.element,b.options);b.uploaded_array=[];b.selected_array=[];h={};f=null}});if(!b.options.mutiple_select){g.button_action=SWFUpload.BUTTON_ACTION.SELECT_FILE}scrupload.initButtonEvent(b,b.swf_container);b.swfuploader=new SWFUpload(g)},_onComplete:function(){this._trigger("onComplete",null,{element:this.element,runtime:this.runtime,uploaded:self.uploaded_array,options:this.options})},_onFileStart:function(c,d,b){this.queue_array.shift();c.post.id=c.id;c.post.post_name=this.options.file_post_name;this.swfuploader.setPostParams(a.extend(d,c.post));url=scrupload.buildUrlQuery(this.options.url,a.extend(b,c.get));this.swfuploader.setUploadURL(url);this._trigger("onFileStart",null,{element:this.element,runtime:this.runtime,file:c,options:this.options})},getRuntime:function(){return this.swfuploader},destroy:function(){this.swfuploader.destroy();this.swf_container.remove();this.queue_array=[];a.Widget.prototype.destroy.apply(this,arguments);return this}})}})(jQuery);(function(a){a.widget("ui.scrupload",{options:{runtimes:"swfupload|http|html4"},_create:function(){this.isIE=(navigator.appVersion.indexOf("MSIE")!=-1)?true:false;this.isWin=(navigator.appVersion.toLowerCase().indexOf("win")!=-1)?true:false;this.isOpera=(navigator.userAgent.indexOf("Opera")!=-1)?true:false;var d=this,c,f=d.options.runtimes.split("|"),g,e,b;b=a('<input type="file" />').appendTo("body").hide();c={html5:!!b[0].files,swfupload:d.detectFlashVer(8,0,0)&&window.SWFUpload,http:true,html4:true};b.remove();f.push("html4");for(e=0;e<f.length;e++){if(c[f[e]]&&d.start(f[e])){break}}},start:function(b){var c=this._getRuntimeName(b);if(this.current_runtime!=b&&this.element[c]){if(this.current_runtime){this.element[this._getRuntimeName(this.current_runtime)]("destroy")}this.element[c](this.options);this.current_runtime=b;return true}return false},_getRuntimeName:function(b){return"scrupload"+b.substr(0,1).toUpperCase()+b.substr(1)},detectFlashVer:function(h,e,d){var f=this._getFlashVesion(),g,b,c;if(f==-1){return false}else{if(f!=0){if(this.isIE&&this.isWin&&!this.isOpera){tempArray=f.split(" ");tempString=tempArray[1];versionArray=tempString.split(",")}else{versionArray=f.split(".")}g=versionArray[0];b=versionArray[1];c=versionArray[2];if(g>parseFloat(h)){return true}else{if(g==parseFloat(h)){if(b>parseFloat(e)){return true}else{if(b==parseFloat(e)){if(c>=parseFloat(d)){return true}}}}}return false}}},_getFlashVesion:function(){var h=-1,g,b,f,d,i,c,e;if(navigator.plugins!=null&&navigator.plugins.length>0){if(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]){g=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"";b=navigator.plugins["Shockwave Flash"+g].description;f=b.split(" ");d=f[2].split(".");i=d[0];c=d[1];e=f[3];if(e==""){e=f[4]}if(e[0]=="d"){e=e.substring(1)}else{if(e[0]=="r"){e=e.substring(1);if(e.indexOf("d")>0){e=e.substring(0,e.indexOf("d"))}}}h=i+"."+c+"."+e}}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.6")!=-1){h=4}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.5")!=-1){h=3}else{if(navigator.userAgent.toLowerCase().indexOf("webtv")!=-1){h=2}else{if(this.isIE&&this.isWin&&!this.isOpera){h=this._getFlashVersionForIE()}}}}}return h},_getFlashVersionForIE:function(){var b,c,d;try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");b=c.GetVariable("$version")}catch(d){}if(!b){try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");b="WIN 6,0,21,0";c.AllowScriptAccess="always";b=c.GetVariable("$version")}catch(d){}}if(!b){try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");b=c.GetVariable("$version")}catch(d){}}if(!b){try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");b="WIN 3,0,18,0"}catch(d){}}if(!b){try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");b="WIN 2,0,0,11"}catch(d){b=-1}}return b},destroy:function(){this.element[this._getRuntimeName(this.current_runtime)]("destroy");this.current_runtime=undefined;a.Widget.prototype.destroy.apply(this,arguments);return this}})})(jQuery);