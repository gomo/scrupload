(function(c,b){if(b.scrupload){return}var d=b.scrupload=b.scrupload||{},a=0;d.SELECTED=1;d.UPLOADING=2;d.FAILED=3;d.DONE=4;d.ERROR_TYPE="TYPE";d.ERROR_SIZE="SIZE";d.ERROR_HTTP="HTTP";d.uniqid=function(g){var f=new Date().getTime().toString(32),e;for(e=0;e<5;e++){f+=Math.floor(Math.random()*65535).toString(32)}return("scrupload-"+f).toString(32)};d.buildUrlQuery=function(e,g){var f=c.param(g);if(!f){return e}else{return f.indexOf("?")!=-1?e+"&"+f:e+"?"+f}};d.generateElementId=function(e){var f=e.attr("id");if(f){return f}while(true){f=this.uniqid();if(c("#"+f).length===0){e.attr("id",f);return f}}};d.buildDefaultOptions=function(g){if(g.types){g.post_params.types=g.types}if(g.size_limit){g.post_params.size_limit=g.size_limit}if(g.size_limit){var f=g.size_limit;var e;if(e=f.match(/^([0-9]+)MB$/i)){g.size_limit=e[1]*1024*1024}else{if(e=f.match(/^([0-9]+)KB$/i)){g.size_limit=e[1]*1024}else{if(e=f.match(/^([0-9]+)B?$/i)){g.size_limit=e[1]}else{throw g.size_limit+" is illegal size_limit value."}}}}};d.checkTypes=function(h,f){if(f.upload!==false&&h.options.types){var g=h.options.types.split("|"),e;if(c.inArray(f.type,g)==-1){f.upload=false;f.status=scrupload.FAILED;h._trigger("onError",null,{element:h.element,file:f,error:scrupload.ERROR_TYPE,runtime:h.runtime,options:h.options})}}};d.checkSize=function(f,e){if(e.upload!==false&&f.options.size_limit&&e.size){if(e.size>f.options.size_limit){e.upload=false;e.status=scrupload.FAILED;f._trigger("onError",null,{element:f.element,file:e,error:scrupload.ERROR_SIZE,runtime:f.runtime,options:f.options})}}};d.defaultOptions=function(e){return c.extend({},{file_post_name:"file",post_params:{},get_params:{},interval:0},e||{})};d.initButtonEvent=function(g,f){var e=false;f.mouseout(function(){if(e){g._trigger("onButtonOut",null,{element:g.element,runtime:g.runtime,options:g.options});e=false}}).mouseover(function(){if(!e){g._trigger("onButtonOver",null,{element:g.element,runtime:g.runtime,options:g.options});e=true}}).mousedown(function(){g._trigger("onButtonDown",null,{element:g.element,runtime:g.runtime,options:g.options})})};d.createFile=function(f,e){return{id:(e.file_id_prefix||"scrfile-"+(++a)),time:new Date(),filename:f.name||f.fileName,size:f.size,type:d.detectFileType(f),status:this.SELECTED,user:{},get:c.extend({},e.get_params),post:c.extend({},e.post_params)}};d.detectFileType=function(f){var g;if(f.type){if(f.type.indexOf("/")==-1){g=f.type.substr(1)}}if(!g){var e=f.name||f.fileName;g=e.substr(e.lastIndexOf(".")+1)}return g.toLowerCase()};d.onSelect=function(g,f){if(f.upload!==false){var e=g._trigger("onSelect",null,{element:g.element,runtime:g.runtime,file:f,options:g.options});if(e===false){f.upload=false}}};d.submitIframForm=function(i,f,j,h){var e=j,g;g=scrupload.createFile({name:f},e.options);(h||c.noop)(g);if(f!="n/a"){scrupload.checkTypes(e,g)}scrupload.onSelect(e,g);e._trigger("onStart",null,{element:e.element,runtime:e.runtime,files:g.upload!==false?[g]:[],options:e.options});if(g.upload!==false){e._trigger("onFileStart",null,{element:e.element,runtime:e.runtime,file:g,options:e.options});i.submit(function(){g.post.id=g.id;c.each(g.post,function(l){i.append('<input type="hidden" name="'+l+'" value="'+this+'" />')});var k=i.attr("action");k=scrupload.buildUrlQuery(k,g.get);i.attr("action",k);g.status=scrupload.UPLOADING;e._trigger("onProgress",null,{element:e.element,runtime:e.runtime,file:g,progress:{percent:0},options:e.options})});i.attr("target",g.id);i.find("input[name=id]").val(g.id);c('<iframe src="about:blank" name="'+g.id+'">').appendTo(document.body).css({width:"1px",height:"1px",position:"absolute",left:"-10000px",top:"-10000px"}).load(function(){var k=c(this),l=c(this.contentWindow.document.body).text();if(l){e._trigger("onProgress",null,{element:e.element,file:g,runtime:e.runtime,progress:{percent:100},options:e.options});g.status=scrupload.DONE;e._trigger("onFileComplete",null,{element:e.element,file:g,runtime:e.runtime,response:l,options:e.options});e._trigger("onComplete",null,{element:e.element,uploaded:[g],runtime:e.runtime,options:e.options})}setTimeout(function(){k.remove();i.remove();e._resetInterface();e.element.removeClass("scr_uploading")},0)});i.submit()}else{i.remove();e._resetInterface();e.element.removeClass("scr_uploading");e._trigger("onComplete",null,{element:e.element,uploaded:[g],runtime:e.runtime,options:e.options})}};d.disableInterface=function(f,e){cover=f.data("disable-cover");if(!cover){cover=c("<div></div>").appendTo(f).css("position","absolute").css("top",0).css("left",0).css("z-index",10000).offset(f.offset()).width(f.width()).height(f.height());f.data("disable-cover",cover)}cover.show()};d.enableInterface=function(f,e){cover=f.data("disable-cover");if(cover){cover.hide()}}})(jQuery,(function(){return this})());(function(b){var a=new RegExp("([^/]+)$");b.widget("ui.scruploadHttp",{options:scrupload.defaultOptions({button_value:"OK"}),_create:function(){var c=this;c.element.addClass("scr_http_container");c.queue_array=[];scrupload.buildDefaultOptions(c.options);c._initInterface();c.runtime={name:"http",object:c.input};c._trigger("onInit",null,{element:c.element,runtime:c.runtime,options:c.options})},_initInterface:function(){var c=this,d;c.container=b("<span></span>").appendTo(c.element);c.input=b('<input type="text">').appendTo(c.container);d=b('<input type="submit" value="'+c.options.button_value+'">').appendTo(c.container);scrupload.initButtonEvent(c,c.container);d.click(function(){var g=b('<form action="'+c.options.url+'" method="post" />'),e="n/a",f=b(this),h=c.input.val();c.element.addClass("scr_uploading");c.input.attr("name",c.options.file_post_name);g.appendTo(c.element).append(c.container);if(a.exec(h)){e=RegExp.$1}scrupload.submitIframForm(g,e,c,function(i){i.http={uri:h};if(i.upload!==false&&!h.match(/^https?:\/\//)){i.upload=false;i.status=scrupload.FAILED;c._trigger("onError",null,{element:c.element,file:i,error:scrupload.ERROR_HTTP,runtime:c.runtime,options:c.options})}});return false})},_resetInterface:function(){this.container.remove();this._initInterface()},destroy:function(){this.element.removeClass("scr_http_container");this.container.remove();this.queue_array=[];this.input=undefined;b.Widget.prototype.destroy.apply(this,arguments);return this}})})(jQuery);(function(a){a.widget("ui.scruploadHtml4",{options:scrupload.defaultOptions({}),_create:function(){var b=this;b.element.addClass("scr_html4_container");b.queue_array=[];scrupload.buildDefaultOptions(b.options);b._initInterface();b.runtime={name:"html4",object:b.input};b._trigger("onInit",null,{element:b.element,runtime:b.runtime,options:b.options})},_initInterface:function(){var b=this;b._createFormAndInput()},_createFormAndInput:function(){var b=this;b.input=a('<input type="file" />');b.container=a("<span />");b.input.appendTo(b.container.appendTo(b.element));scrupload.initButtonEvent(b,b.container);b.input.change(function(){var f=a('<form action="'+b.options.url+'" method="post" enctype="multipart/form-data" />'),e="n/a",c,d=a(this);b.element.addClass("scr_uploading");d.attr("name",b.options.file_post_name);f.appendTo(b.element).append(b.container);if(this.value){e=this.value;c=e.match(/[\/\\]([^\/\\]+)$/i);if(c){e=c[1]}}scrupload.submitIframForm(f,e,b)})},_resetInterface:function(){this.container.remove();this._initInterface()},destroy:function(){this.element.removeClass("scr_html4_container");this.container.remove();this.queue_array=[];this.input=undefined;a.Widget.prototype.destroy.apply(this,arguments);return this}})})(jQuery);(function(a){a.widget("ui.scruploadHtml5",{options:scrupload.defaultOptions({mutiple_select:true}),_create:function(){var b=this;b.element.addClass("scr_html5_container");b.queue_array=[];scrupload.buildDefaultOptions(b.options);b._initInterface();b.runtime={name:"html5",object:b.input};b._trigger("onInit",null,{element:b.element,runtime:b.runtime,options:b.options})},_initInterface:function(){var b=this;b._createFormAndInput()},_createFormAndInput:function(){var b=this,c;c=b.options.file_post_name;if(b.options.mutiple_select){b.input=a('<input type="file" name="'+c+'" multiple />')}else{b.input=a('<input type="file" name="'+c+'" />')}b.container=a("<span />");b.input.appendTo(b.container.appendTo(b.element));scrupload.initButtonEvent(b,b.container);b.input.change(function(){var e,f,d="n/a",n,l=a(this),g=[],h,k;b.input.attr("disabled","disabled");b.element.addClass("scr_uploading");f=a('<form method="post" enctype="multipart/form-data" />');f.appendTo(b.element).append(b.container);for(var j=0;j<this.files.length;j++){h=scrupload.createFile(this.files[j],b.options);fd=new FormData();fd.append(c,this.files[j]);fd.append("id",h.id);for(var m in h.post){fd.append(m,h.post[m])}e=scrupload.buildUrlQuery(b.options.url,h.get);f.attr("action",e);h.html5={formData:fd,uri:e};scrupload.checkTypes(b,h);scrupload.checkSize(b,h);scrupload.onSelect(b,h);if(h.upload!==false){b.queue_array.push(h)}}b._trigger("onStart",null,{element:b.element,runtime:b.runtime,files:b.queue_array,options:b.options});k=b.queue_array.shift();if(k){b._onFileStart(k);b._upload(k,g)}else{b._onComplete(g)}})},_upload:function(c,b){var d=new XMLHttpRequest();this._setAjaxEventListener(d,c,b);d.open("POST",c.html5.uri);d.send(c.html5.formData)},_onFileStart:function(b){this._trigger("onFileStart",null,{element:this.element,runtime:this.runtime,file:b,options:this.options})},_setAjaxEventListener:function(e,d,b){var c=this;e.upload.addEventListener("progress",function(g){d.status=scrupload.UPLOADING;if(g.lengthComputable){var f=Math.round(g.loaded*100/g.total);c._trigger("onProgress",null,{element:c.element,runtime:c.runtime,file:d,options:c.options,progress:{percent:f,bytes_loaded:g.loaded,bytes_total:g.total}})}},false);e.addEventListener("load",function(g){var f;d.status=scrupload.DONE;c._trigger("onFileComplete",null,{element:c.element,runtime:c.runtime,file:d,response:g.target.responseText,options:c.options});b.push(d);if(c.queue_array.length==0){c._onComplete(b)}else{f=c.queue_array.shift();c._onFileStart(f);setTimeout(function(){c._upload(f,b)},c.options.interval)}},false)},_onComplete:function(b){this._trigger("onComplete",null,{element:this.element,runtime:this.runtime,uploaded:b,options:this.options});this._resetInterface()},_resetInterface:function(){this.container.remove();this._initInterface()},destroy:function(){this.element.removeClass("scr_html5_container");this.container.remove();this.queue_array=[];this.input=undefined;a.Widget.prototype.destroy.apply(this,arguments);return this}})})(jQuery);(function(a){if(window.SWFUpload){a.widget("ui.scruploadSwfupload",{options:scrupload.defaultOptions({swfupload:{prevent_swf_caching:false,button_cursor:SWFUpload.CURSOR.HAND},mutiple_select:true}),_create:function(){var b=this;b.queue_array=[];scrupload.buildDefaultOptions(b.options);b._initInterface()},_initInterface:function(){var j=this,b={},d=[],k,c={},h={},g,e,f;j.swf_container=a("<div><div></div></div>").appendTo(j.element);j.swf_container.width(j.options.swfupload.button_width);j.swf_container.height(j.options.swfupload.button_height);if(j.options.swfupload.cookie){if(!a.cookie){throw'It is require "jquery.cookie.js" to use cookie option.'}if((j.options.swfupload.cookie_method||"get").toLowerCase()=="get"){for(g=0;g<j.options.swfupload.cookie.length;g++){h[j.options.swfupload.cookie[g]]=a.cookie(j.options.swfupload.cookie[g])}}else{for(g=0;g<j.options.swfupload.cookie.length;g++){c[j.options.swfupload.cookie[g]]=a.cookie(j.options.swfupload.cookie[g])}}delete j.options.swfupload.cookie;delete j.options.swfupload.cookie_method}j.swfuploader=null;k=a.extend(j.options.swfupload,{file_post_name:j.options.file_post_name,upload_url:j.options.url,file_size_limit:j.options.size_limit,button_placeholder_id:scrupload.generateElementId(j.swf_container.find("div")),preserve_relative_urls:true,button_window_mode:SWFUpload.WINDOW_MODE.TRANSPARENT,swfupload_loaded_handler:function(){j.runtime={name:"swfupload",object:j.swfuploader};j._trigger("onInit",null,{element:j.element,runtime:j.runtime,options:j.options})},file_dialog_start_handler:function(l,i,m){f=false},file_queued_handler:function(l){var i=scrupload.createFile(l,j.options);f=true;i.swfupload={file:l};scrupload.checkTypes(j,i);scrupload.checkSize(j,i);scrupload.onSelect(j,i);if(i.upload!==false){j.queue_array.push(i);b[l.id]=i}else{this.cancelUpload(l.id)}return i.upload},file_dialog_complete_handler:function(i,l){j._trigger("onStart",null,{element:j.element,runtime:j.runtime,files:j.queue_array,options:j.options});if(j.queue_array.length>0){scrupload.disableInterface(j.element,j.options);this.startUpload()}else{if(f){j._onComplete(d)}}},upload_start_handler:function(n){var m=b[n.id],l,i=this;if(d.length>0){if(e!=m){this.stopUpload();e=m;j._onFileStart(m,c,h);setTimeout(function(){j.swfuploader.startUpload()},j.options.interval)}}else{e=m;j._onFileStart(m,c,h);j.swfuploader.startUpload()}},upload_progress_handler:function(o,l,n){var i=b[o.id],m=Math.ceil((l/n)*100);i.status=scrupload.UPLOADING;j._trigger("onProgress",null,{element:j.element,runtime:j.runtime,file:i,options:j.options,progress:{percent:m,bytes_loaded:l,bytes_total:n}})},upload_success_handler:function(l,m){var i=b[l.id];i.status=scrupload.DONE;d.push(i);j._trigger("onFileComplete",null,{element:j.element,runtime:j.runtime,file:i,response:m,options:j.options})},queue_complete_handler:function(i){j._onComplete(d);scrupload.enableInterface(j.element,j.options);d=[];b={};e=null}});if(!j.options.mutiple_select){k.button_action=SWFUpload.BUTTON_ACTION.SELECT_FILE}scrupload.initButtonEvent(j,j.swf_container);j.swfuploader=new SWFUpload(k)},_onComplete:function(b){this._trigger("onComplete",null,{element:this.element,runtime:this.runtime,uploaded:b,options:this.options})},_onFileStart:function(c,d,b){this.queue_array.shift();c.post.id=c.id;this.swfuploader.setPostParams(a.extend(d,c.post));url=scrupload.buildUrlQuery(this.options.url,a.extend(b,c.get));this.swfuploader.setUploadURL(url);this._trigger("onFileStart",null,{element:this.element,runtime:this.runtime,file:c,options:this.options})},getRuntime:function(){return this.swfuploader},destroy:function(){this.swfuploader.destroy();this.swf_container.remove();this.queue_array=[];a.Widget.prototype.destroy.apply(this,arguments);return this}})}})(jQuery);(function(a){a.widget("ui.scrupload",{options:{runtimes:"swfupload|http|html4"},_create:function(){this.isIE=(navigator.appVersion.indexOf("MSIE")!=-1)?true:false;this.isWin=(navigator.appVersion.toLowerCase().indexOf("win")!=-1)?true:false;this.isOpera=(navigator.userAgent.indexOf("Opera")!=-1)?true:false;var d=this,c,f=d.options.runtimes.split("|"),g,e,b;b=a('<input type="file" />').appendTo("body").hide();c={html5:!!b[0].files,swfupload:d.detectFlashVer(8,0,0)&&window.SWFUpload,http:true,html4:true};b.remove();f.push("html4");for(e=0;e<f.length;e++){if(c[f[e]]&&d.start(f[e])){break}}},start:function(b){var c=this._getRuntimeName(b);if(this.current_runtime!=b&&this.element[c]){if(this.current_runtime){this.element[this._getRuntimeName(this.current_runtime)]("destroy")}this.element[c](this.options);this.current_runtime=b;return true}return false},_getRuntimeName:function(b){return"scrupload"+b.substr(0,1).toUpperCase()+b.substr(1)},detectFlashVer:function(h,e,d){var f=this._getFlashVesion(),g,b,c;if(f==-1){return false}else{if(f!=0){if(this.isIE&&this.isWin&&!this.isOpera){tempArray=f.split(" ");tempString=tempArray[1];versionArray=tempString.split(",")}else{versionArray=f.split(".")}g=versionArray[0];b=versionArray[1];c=versionArray[2];if(g>parseFloat(h)){return true}else{if(g==parseFloat(h)){if(b>parseFloat(e)){return true}else{if(b==parseFloat(e)){if(c>=parseFloat(d)){return true}}}}}return false}}},_getFlashVesion:function(){var h=-1,g,b,f,d,i,c,e;if(navigator.plugins!=null&&navigator.plugins.length>0){if(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]){g=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"";b=navigator.plugins["Shockwave Flash"+g].description;f=b.split(" ");d=f[2].split(".");i=d[0];c=d[1];e=f[3];if(e==""){e=f[4]}if(e[0]=="d"){e=e.substring(1)}else{if(e[0]=="r"){e=e.substring(1);if(e.indexOf("d")>0){e=e.substring(0,e.indexOf("d"))}}}h=i+"."+c+"."+e}}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.6")!=-1){h=4}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.5")!=-1){h=3}else{if(navigator.userAgent.toLowerCase().indexOf("webtv")!=-1){h=2}else{if(this.isIE&&this.isWin&&!this.isOpera){h=this._getFlashVersionForIE()}}}}}return h},_getFlashVersionForIE:function(){var b,c,d;try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");b=c.GetVariable("$version")}catch(d){}if(!b){try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");b="WIN 6,0,21,0";c.AllowScriptAccess="always";b=c.GetVariable("$version")}catch(d){}}if(!b){try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");b=c.GetVariable("$version")}catch(d){}}if(!b){try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");b="WIN 3,0,18,0"}catch(d){}}if(!b){try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");b="WIN 2,0,0,11"}catch(d){b=-1}}return b},destroy:function(){this.element[this._getRuntimeName(this.current_runtime)]("destroy");this.current_runtime=undefined;a.Widget.prototype.destroy.apply(this,arguments);return this}})})(jQuery);