(function(b,a){if(a.scrupload){return}var c=a.scrupload=a.scrupload||{},d=0;c.SELECTED=1;c.UPLOADING=2;c.FAILED=3;c.DONE=4;c.ERROR_TYPE=10;c.ERROR_SIZE_LIMIT=11;c.ERROR_QUEUE_LIMIT=12;c.uniqid=function(g){var f=new Date().getTime().toString(32),e;for(e=0;e<5;e++){f+=Math.floor(Math.random()*65535).toString(32)}return(g||"s")+f+(d++).toString(32)};c.buildUrlQuery=function(e,g){var f=b.param(g);return f.indexOf("?")!=-1?e+"&"+f:e+"?"+f};c.generateElementId=function(e){var f=e.attr("id");if(f){return f}while(true){f=this.uniqid();if(b("#"+f).length===0){e.attr("id",f);return f}}};c.buildDefaultPostParams=function(e){if(e.types){e.post_params.types=e.types}if(e.size_limit){e.post_params.size_limit=e.size_limit}};c.checkTypes=function(g,e){var h=g.split("|"),f;for(f=0;f<h.length;f++){if(e.toLowerCase().lastIndexOf(h[f].toLowerCase())==e.length-h[f].length){return true}}return false};c.defaultOptions=function(e){return b.extend({},{file_post_name:"file",post_params:{},get_params:{}},e||{})};c.initButtonEvent=function(g,f){var e=false;f.mouseout(function(){if(e){g._trigger("onButtonOut",null,{element:g.element,runtime:g.runtime,options:g.options});e=false}}).mouseover(function(){if(!e){g._trigger("onButtonOver",null,{element:g.element,runtime:g.runtime,options:g.options});e=true}}).mousedown(function(){g._trigger("onButtonDown",null,{element:g.element,runtime:g.runtime,options:g.options})})};c.createFile=function(e,f){return{id:this.uniqid(f.file_id_prefix),time:new Date(),filename:e,status:this.SELECTED,user:{},get:b.extend({},f.get_params),post:b.extend({},f.post_params)}};c.submitIframForm=function(h,f,i){var e=i,g;g=scrupload.createFile(f,e.options);if(e.options.types&&f!="n/a"){if(!scrupload.checkTypes(e.options.types,f)){g.status=scrupload.FAILED;e._trigger("onError",null,{element:e.element,file:g,error:scrupload.ERROR_TYPE,runtime:e.runtime,options:e.options});e._resetInterface();return}}if(e.options.queue_limit&&e.queue_array.length==e.options.queue_limit){g.status=scrupload.FAILED;e._trigger("onError",null,{element:e.element,file:g,error:scrupload.ERROR_QUEUE_LIMIT,runtime:e.runtime,options:e.options});e._resetInterface();return}e.queue_array.push(g);e._trigger("onSelect",null,{element:e.element,runtime:e.runtime,file:g,options:e.options});h.submit(function(){g.post.id=g.id;b.each(g.post,function(k){h.append('<input type="hidden" name="'+k+'" value="'+this+'" />')});var j=h.attr("action");j=scrupload.buildUrlQuery(j,g.get);h.attr("action",j);g.status=scrupload.UPLOADING;e._trigger("onProgress",null,{element:e.element,runtime:e.runtime,file:g,progress:{percent:0},options:e.options})});h.attr("target",g.id);h.find("input[name=id]").val(g.id);b('<iframe src="about:blank" name="'+g.id+'">').appendTo(document.body).css({width:"1px",height:"1px",position:"absolute",left:"-10000px",top:"-10000px"}).load(function(){var j=b(this),k=b(this.contentWindow.document.body).text();if(k){e._trigger("onProgress",null,{element:e.element,file:g,runtime:e.runtime,progress:{percent:100},options:e.options});g.status=scrupload.DONE;e._trigger("onFileComplete",null,{element:e.element,file:g,runtime:e.runtime,response:k,options:e.options});e._trigger("onComplete",null,{element:e.element,uploaded:[g],runtime:e.runtime,files:e.queue_array,options:e.options})}setTimeout(function(){j.remove();h.remove();e._resetInterface();e.element.removeClass("scr_uploading")},0)});h.submit()}})(jQuery,(function(){return this})());(function(b){var a=new RegExp("([^/]+)$");b.widget("ui.scruploadHttp",{options:scrupload.defaultOptions({button_value:"OK"}),_create:function(){var c=this;c.element.addClass("scr_http_container");c.queue_array=[];scrupload.buildDefaultPostParams(c.options);c._initInterface();c.runtime={name:"http",object:c.input};c._trigger("onInit",null,{element:c.element,runtime:c.runtime,options:c.options})},_initInterface:function(){var c=this,d;c.container=b("<span></span>").appendTo(c.element);c.input=b('<input type="text">').appendTo(c.container);d=b('<input type="submit" value="'+c.options.button_value+'">').appendTo(c.container);scrupload.initButtonEvent(c,c.container);d.click(function(){var g=b('<form action="'+c.options.url+'" method="post" />'),e="n/a",f=b(this);c.element.addClass("scr_uploading");c.input.attr("name",c.options.file_post_name);g.appendTo(c.element).append(c.container);if(a.exec(c.input.val())){e=RegExp.$1}scrupload.submitIframForm(g,e,c);return false})},_resetInterface:function(){this.container.remove();this._initInterface()},destroy:function(){this.element.removeClass("scr_http_container");this.container.remove();this.queue_array=[];this.input=undefined;b.Widget.prototype.destroy.apply(this,arguments);return this}})})(jQuery);(function(a){a.widget("ui.scruploadHtml4",{options:scrupload.defaultOptions({}),_create:function(){var b=this;b.element.addClass("scr_html4_container");b.queue_array=[];scrupload.buildDefaultPostParams(b.options);b._initInterface();b.runtime={name:"html4",object:b.input};b._trigger("onInit",null,{element:b.element,runtime:b.runtime,options:b.options})},_initInterface:function(){var b=this;b._createFormAndInput()},_createFormAndInput:function(){var b=this;b.input=a('<input type="file" />');b.container=a("<span />");b.input.appendTo(b.container.appendTo(b.element));scrupload.initButtonEvent(b,b.container);b.input.change(function(){var f=a('<form action="'+b.options.url+'" method="post" enctype="multipart/form-data" />'),e="n/a",c,d=a(this);b.element.addClass("scr_uploading");d.attr("name",b.options.file_post_name);f.appendTo(b.element).append(b.container);if(this.value){e=this.value;c=e.match(/[\/\\]([^\/\\]+)$/i);if(c){e=c[1]}}scrupload.submitIframForm(f,e,b)})},_resetInterface:function(){this.container.remove();this._initInterface()},destroy:function(){this.element.removeClass("scr_html4_container");this.container.remove();this.queue_array=[];this.input=undefined;a.Widget.prototype.destroy.apply(this,arguments);return this}})})(jQuery);(function(a){a.widget("ui.scruploadHtml5",{options:scrupload.defaultOptions({}),_create:function(){var b=this;b.element.addClass("scr_html5_container");b.queue_array=[];scrupload.buildDefaultPostParams(b.options);b._initInterface();b.runtime={name:"html5",object:b.input};b._trigger("onInit",null,{element:b.element,runtime:b.runtime,options:b.options})},_initInterface:function(){var b=this;b._createFormAndInput()},_createFormAndInput:function(){var b=this,c;if(b.options.queue_limit>1){c=b.options.file_post_name+"[]";b.input=a('<input type="file" name="'+c+'" multiple />')}else{c=b.options.file_post_name;b.input=a('<input type="file" name="'+c+'" />')}b.container=a("<span />");b.input.appendTo(b.container.appendTo(b.element));scrupload.initButtonEvent(b,b.container);b.input.change(function(){if(b.options.upload_limit&&this.files.length>b.options.upload_limit){b._trigger("onError",null,{element:b.element,file:null,error:scrupload.ERROR_QUEUE_LIMIT,runtime:b.runtime,options:b.options});b._resetInterface();return}var e=b.options.url,g,d="n/a",p,m=a(this),h,o,j,l=this.files.length,f=[];b.element.addClass("scr_uploading");g=a('<form method="post" enctype="multipart/form-data" />');g.appendTo(b.element).append(b.container);for(var k=0;k<this.files.length;k++){file=scrupload.createFile(this.files[k].fileName,b.options);b.queue_array.push(file);h=new FormData();h.append(c,this.files[k]);for(var n in file.post){h.append(n,file.post[n])}e=scrupload.buildUrlQuery(e,file.get);g.attr("action",e);b._trigger("onSelect",null,{element:b.element,runtime:b.runtime,file:file,options:b.options});o=new XMLHttpRequest();o.upload.addEventListener("progress",function(q){file.status=scrupload.UPLOADING;if(q.lengthComputable){var i=Math.round(q.loaded*100/q.total);b._trigger("onProgress",null,{element:b.element,runtime:b.runtime,file:file,progress:{percent:i,bytes_loaded:q.loaded,bytes_total:q.total,options:b.options}})}},false);o.addEventListener("load",function(i){file.status=scrupload.DONE;b._trigger("onFileComplete",null,{element:b.element,runtime:b.runtime,file:file,response:i.target.responseText,options:b.options});f.push(file)},false);o.open("POST",e);o.send(h)}j=setInterval(function(){if(l==f.length){clearInterval(j);b._trigger("onComplete",null,{element:b.element,runtime:b.runtime,uploaded:f,files:b.queue_array,options:b.options});m.val("");f=[]}},80)})},_resetInterface:function(){this.container.remove();this._initInterface()},destroy:function(){this.element.removeClass("scr_html5_container");this.container.remove();this.queue_array=[];this.input=undefined;a.Widget.prototype.destroy.apply(this,arguments);return this}})})(jQuery);(function(a){if(window.SWFUpload){a.widget("ui.scruploadSwfupload",{options:scrupload.defaultOptions({swfupload:{prevent_swf_caching:false,button_cursor:SWFUpload.CURSOR.HAND},mutiple_select:true}),_create:function(){var b=this;b.queue_array=[];scrupload.buildDefaultPostParams(b.options);b._initInterface()},_initInterface:function(){var c=this,e={},b=[],d;c.swf_container=a("<div><div></div></div>").appendTo(c.element);c.swf_container.width(c.options.swfupload.button_width);c.swf_container.height(c.options.swfupload.button_height);c.swfuploader=null;d=a.extend(c.options.swfupload,{file_upload_limit:c.options.upload_limit||0,file_post_name:c.options.file_post_name,upload_url:c.options.url,file_size_limit:c.options.size_limit,button_placeholder_id:scrupload.generateElementId(c.swf_container.find("div")),preserve_relative_urls:true,button_window_mode:SWFUpload.WINDOW_MODE.TRANSPARENT,swfupload_loaded_handler:function(){c.runtime={name:"swfupload",object:c.swfuploader};c._trigger("onInit",null,{element:c.element,runtime:c.runtime,options:c.options})},file_queued_handler:function(g){var f=scrupload.createFile(g.name,c.options);if(c.options.queue_limit&&c.queue_array.length==c.options.queue_limit){f.status=scrupload.FAILED;c._trigger("onError",null,{element:c.element,file:f,error:scrupload.ERROR_QUEUE_LIMIT,runtime:c.runtime,options:c.options});this.cancelUpload(g.id)}else{c.queue_array.push(f);b.push(f);e[g.id]=f;c._trigger("onSelect",null,{element:c.element,runtime:c.runtime,file:f,options:c.options})}},file_dialog_complete_handler:function(f,g){this.startUpload()},upload_start_handler:function(h){var g=e[h.id],f;g.post.id=g.id;this.setPostParams(g.post);f=scrupload.buildUrlQuery(c.options.url,g.get);this.setUploadURL(f)},upload_progress_handler:function(j,g,i){var f=e[j.id],h=Math.ceil((g/i)*100);f.status=scrupload.UPLOADING;c._trigger("onProgress",null,{element:c.element,runtime:c.runtime,file:f,progress:{percent:h,bytes_loaded:g,bytes_total:i,options:c.options}})},upload_success_handler:function(g,h){var f=e[g.id];f.status=scrupload.DONE;c._trigger("onFileComplete",null,{element:c.element,runtime:c.runtime,file:f,response:h,options:c.options})},queue_complete_handler:function(f){c._trigger("onComplete",null,{element:c.element,runtime:c.runtime,uploaded:b,files:c.queue_array,options:c.options});b=[];e={}},file_queue_error_handler:function(f,h,g){c._trigger("onError",null,{element:c.element,file:null,error:scrupload.ERROR_QUEUE_LIMIT,runtime:c.runtime,options:c.options})}});if(!c.options.mutiple_select){d.button_action=SWFUpload.BUTTON_ACTION.SELECT_FILE}scrupload.initButtonEvent(c,c.swf_container);c.swfuploader=new SWFUpload(d)},getRuntime:function(){return this.swfuploader},destroy:function(){this.swfuploader.destroy();this.swf_container.remove();this.queue_array=[];a.Widget.prototype.destroy.apply(this,arguments);return this}})}})(jQuery);(function(a){a.widget("ui.scrupload",{options:{runtimes:"swfupload|http|html4"},_create:function(){this.isIE=(navigator.appVersion.indexOf("MSIE")!=-1)?true:false;this.isWin=(navigator.appVersion.toLowerCase().indexOf("win")!=-1)?true:false;this.isOpera=(navigator.userAgent.indexOf("Opera")!=-1)?true:false;var d=this,c,f=d.options.runtimes.split("|"),g,e,b;b=a('<input type="file" />').appendTo("body").hide();c={html5:!!b[0].files,swfupload:d.detectFlashVer(8,0,0)&&window.SWFUpload,http:true,html4:true};b.remove();f.push("html4");for(e=0;e<f.length;e++){if(c[f[e]]&&d.start(f[e])){break}}},start:function(b){var c=this._getRuntimeName(b);if(this.current_runtime!=b&&this.element[c]){if(this.current_runtime){this.element[this._getRuntimeName(this.current_runtime)]("destroy")}this.element[c](this.options);this.current_runtime=b;return true}return false},_getRuntimeName:function(b){return"scrupload"+b.substr(0,1).toUpperCase()+b.substr(1)},detectFlashVer:function(h,e,d){var f=this._getFlashVesion(),g,b,c;if(f==-1){return false}else{if(f!=0){if(this.isIE&&this.isWin&&!this.isOpera){tempArray=f.split(" ");tempString=tempArray[1];versionArray=tempString.split(",")}else{versionArray=f.split(".")}g=versionArray[0];b=versionArray[1];c=versionArray[2];if(g>parseFloat(h)){return true}else{if(g==parseFloat(h)){if(b>parseFloat(e)){return true}else{if(b==parseFloat(e)){if(c>=parseFloat(d)){return true}}}}}return false}}},_getFlashVesion:function(){var h=-1,g,b,f,d,i,c,e;if(navigator.plugins!=null&&navigator.plugins.length>0){if(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]){g=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"";b=navigator.plugins["Shockwave Flash"+g].description;f=b.split(" ");d=f[2].split(".");i=d[0];c=d[1];e=f[3];if(e==""){e=f[4]}if(e[0]=="d"){e=e.substring(1)}else{if(e[0]=="r"){e=e.substring(1);if(e.indexOf("d")>0){e=e.substring(0,e.indexOf("d"))}}}h=i+"."+c+"."+e}}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.6")!=-1){h=4}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.5")!=-1){h=3}else{if(navigator.userAgent.toLowerCase().indexOf("webtv")!=-1){h=2}else{if(this.isIE&&this.isWin&&!this.isOpera){h=this._getFlashVersionForIE()}}}}}return h},_getFlashVersionForIE:function(){var b,c,d;try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");b=c.GetVariable("$version")}catch(d){}if(!b){try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");b="WIN 6,0,21,0";c.AllowScriptAccess="always";b=c.GetVariable("$version")}catch(d){}}if(!b){try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");b=c.GetVariable("$version")}catch(d){}}if(!b){try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");b="WIN 3,0,18,0"}catch(d){}}if(!b){try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");b="WIN 2,0,0,11"}catch(d){b=-1}}return b},destroy:function(){this.element[this._getRuntimeName(this.current_runtime)]("destroy");this.current_runtime=undefined;a.Widget.prototype.destroy.apply(this,arguments);return this}})})(jQuery);